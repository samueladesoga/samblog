<!DOCTYPE html>
<html lang="en-us">

    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta property="description" content="I have recently switched from carrierwave to shrine in my Rails app and i thought i follow the advice of Alan Richardson, saying when you learn something new, irregardless of how trivial it might seem to you, share it and save someone else that headache.
So in the Yangah application, we upload a number of files to amazon s3 which include images, font files and css files for these fonts. However, i have found that with shrine, out of the box it was not able to correctly set the mime type for the uploaded file on s3." />
        <meta name="author" content="Samuel Adesoga">

        <link rel="shortcut icon" href="https://samblog-a664e.firebaseapp.com/images/favicon.ico">

         <title>Sam Adesoga&#39;s Personal Blog  | Uploading CSS files using &#34;Shrine&#34; gem</title>

        <meta name="generator" content="Hugo 0.40.3" />
        
        
            <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">
        


        
        <link href="https://fonts.googleapis.com/css?family=Nunito+Sans:300,600,700" rel="stylesheet">

        
        <link href="https://samblog-a664e.firebaseapp.com/css/bootstrap.min.css" rel="stylesheet">

        
        <link href="https://samblog-a664e.firebaseapp.com/css/metismenu.min.css" rel="stylesheet" type="text/css" />

        
        <link rel="stylesheet" type="text/css" href="https://samblog-a664e.firebaseapp.com/css/materialdesignicons.min.css">

        
        <link href="https://samblog-a664e.firebaseapp.com/css/style.css" rel="stylesheet" type="text/css" />
        <link href="https://samblog-a664e.firebaseapp.com/css/default.css" rel="stylesheet" type="text/css" />

    </head>

    <body>
        
        <div id="wrapper">
            
            <div class="topbar-mobile">
    <div class="logo">
        <a href="https://samblog-a664e.firebaseapp.com/"><img src="https://samblog-a664e.firebaseapp.com/images/logo.png" alt="" class="" style="height: 84px;"></a>
        <button class="button-menu-mobile">
            <i class="mdi mdi-menu"></i>
        </button>
    </div>
</div>
            
            
            <div class="left side-menu">

    <div class="slimscroll-menu" id="remove-scroll">

        <div class="logo">
            <a href="https://samblog-a664e.firebaseapp.com/"><img src="https://samblog-a664e.firebaseapp.com/images/logo.png" alt="" class="" style="height: 84px;"></a>
            <p class="text-muted">A pragmatic problem solver and business leader with a very solid technical background.</p>
        </div>

        
        <div id="sidebar-menu">
            
            <ul class="metismenu" id="side-menu">

                
                    <li>
                        <a href="https://samblog-a664e.firebaseapp.com/">Home</a>
                    </li>
                
                    <li>
                        <a href="https://samblog-a664e.firebaseapp.com/categories/feature">Feature</a>
                    </li>
                
                    <li>
                        <a href="https://samblog-a664e.firebaseapp.com/categories/technical">Technical</a>
                    </li>
                
                    <li>
                        <a href="https://samblog-a664e.firebaseapp.com/categories/agile-delivery">Agile Delivery</a>
                    </li>
                
                    <li>
                        <a href="https://samblog-a664e.firebaseapp.com/about/">About</a>
                    </li>
                
                    <li>
                        <a href="https://samblog-a664e.firebaseapp.com/contact/">Contact</a>
                    </li>
                

            </ul>

            <div class="copyright-box">
                <p>2018 Â© Samuel Adesoga. </p>
            </div>

        </div>
        
        <div class="clearfix"></div>

    </div>
    

</div>
            

            <div class="page-wrapper">
                
	<section class="pb-5">
	    <div class="container">

	        <div class="row pt-5">
	            
	            <div class="col-xl-8">

	                
	                <article class="post">
	                    <div class="post-header">
	                        <h2 class="post-title"><a href="#">Uploading CSS files using &#34;Shrine&#34; gem</a></h2>
	                        <ul class="post-meta">
	                            <li><i class="mdi mdi-calendar"></i> April 2, 2017 </li>
	                            <li><i class="mdi mdi-tag-text-outline"></i> 
	                            	
								      
								        <a href="https://samblog-a664e.firebaseapp.com/categories/technical">technical</a>,
								      
		            				 
	                            </li>
	                            <li><i class="mdi mdi-comment-multiple-outline"></i> <a href="#">3 Comments</a>
	                            </li>
	                        </ul>
	                    </div>

	                    <div class="post-preview">
	                        <a href="blog-single.html"><img src="https://samblog-a664e.firebaseapp.com/images/blog/blog-1.jpg" alt="" class="img-fluid rounded"></a>
	                    </div>

	                    <div class="blog-detail-description">
	                        <p>I have recently switched from <a href="https://github.com/carrierwaveuploader/carrierwave">carrierwave</a> to <a href="https://github.com/janko-m/shrine">shrine</a> in my Rails <a href="http://www.yangah.com/">app</a> and i thought i follow the advice of <a href="http://www.eviltester.com">Alan Richardson</a>, saying when you learn something new, irregardless of how trivial it might seem to you, share it and save someone else that headache.</p>

<p>So in the <a href="http://www.yangah.com/">Yangah</a> application, we upload a number of files to amazon s3 which include images, font files and css files for these fonts. However, i have found that with shrine, out of the box it was not able to correctly set the mime type for the uploaded file on s3.</p>

<p>I actually did try to fix this myself and eventually reach out to the Shrine google group and Janko, the author of the Shrine gem was able to provided a suggestion which worked first time and i am grateful for that.</p>

<p>Here is a link to the actual thread but just incase it gets deleted; this is extract of the message sent by Janko.
<blockquote>The <code>determine_mime_type</code> plugin uses the &ldquo;file&rdquo; utility by default for recognizing the MIME type, and it seems to recognize .css files as &ldquo;text/plain&rdquo; (and it&rsquo;s the same for .js files). As noted in the <code>determine_mime_type</code> plugin documentation, one analyzer won&rsquo;t be able to correctly detect correctly all types of files.
<div>For text-based file formats (non-binary) it&rsquo;s probably better to use the &ldquo;mime_types&rdquo; analyzer, which uses the mime-types gem to determine the MIME type from the file extension directly (rather than file content). So you could built a custom analyzer that mixes and matches &ldquo;file&rdquo; and &ldquo;mime_types&rdquo; analyzers; trying the &ldquo;file&rdquo; analyzer first, and if the best MIME type that it could come up with was &ldquo;text/plain&rdquo; (which is technically correct), then you can call the &ldquo;mime_types&rdquo; analyzer to determine which text-based format is it exactly.</div>
<div></div>
<div>This way you still get the benefits of the <code>file</code> utility preventing someone from uploading a binary file with a .css extension, and use the precision of determining from file extension when needed.</div></blockquote>
<div></p>

<p>I installed the gem &ldquo;mime_type&rdquo; and update the FileUploader class with code snippet below.</p>

<p>plugin :determine_mime_type, analyzer: <b>-&gt;</b>(io, analyzers) <b>do</b>
<p style="padding-left:30px;">mime_type <b>=</b> analyzers<b>[</b>:file<b>].</b>call(io)</p>
<p style="padding-left:30px;">mime_type <b>=</b> analyzers<b>[</b>:mime_types<b>].</b>call(io) <b>if</b> mime_type <b>==</b> &ldquo;text/plain&rdquo;</p>
<p style="padding-left:30px;">mime_type</p>
<b>end</b></p>

<p></div>
&nbsp;</p>

<p>And that&rsquo;s it!!! i have the css file now being uploaded correctly with the mime type of &ldquo;text/css&rdquo;.</p>

<p>&nbsp;</p>

<p>&nbsp;</p>

<p>&nbsp;</p>

<p>&nbsp;</p>


	                        <div class="mt-5">
	                            <h6>Tags:</h6>
						            
							            <div class="tagcloud">
									      
									        <a href="https://samblog-a664e.firebaseapp.com/tags/development">Development</a>
									      
									        <a href="https://samblog-a664e.firebaseapp.com/tags/image-upload">Image Upload</a>
									      
									        <a href="https://samblog-a664e.firebaseapp.com/tags/ruby-on-rails">Ruby On Rails</a>
									      
							            </div>
						            
	                        </div>

	                        <div class="mt-5 text-center">
	                            <h5 class="page-title-alt"><span>You Might Also Like</span></h5>
	                        </div>
	                        <div class="row">
					           
							   	<div class="col-sm-4">
					               	<article class="related-post">
					                  <div class="post-preview">
					                     <a href="/posts/rails3-link_to-displays-literal-html-on-front-end/"><img src="https://samblog-a664e.firebaseapp.com/images/blog/blog-2.jpg" alt="" class="img-fluid rounded"></a>
					                  </div>
					                  <div class="post-header">
					                     <h6><a href="/posts/rails3-link_to-displays-literal-html-on-front-end/" title="">Rails3 &lsquo;link_to&rsquo; displays literal HTML on front end</a></h6>
					                     <p> </p>
					                     <p class="post-date">December 22, 2010</p>
					                  </div>
					               	</article>
				            	</div>
							  
						  </div>                

	                        <div class="mt-5">
	                            <h5 class="page-title-alt"><span>Comments</span></h5>
	                        </div>

	                        <ul class="media-list list-unstyled">

	                            <li class="media">
	                                <img class="d-flex mr-3 rounded-circle" src="images/user/user-2.png" alt="Generic placeholder image">
	                                <div class="media-body">
	                                    <a href="#" class="text-custom reply-btn"><i class="mdi mdi-reply"></i>&nbsp; Reply</a>
	                                    <h4 class="media-heading"><a href="">Ronda Otoole</a></h4>
	                                    <p class="text-muted post-date">Jun 23, 2017, 11:45 am</p>
	                                    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nam viverra euismod odio, gravida pellentesque urna varius vitae. Sed dui lorem, adipiscing in adipiscing et, interdum nec metus. Mauris ultricies, justo eu convallis placerat, felis enim.</p>

	                                    <div class="media">
	                                        <img class="d-flex mr-3 rounded-circle" src="images/user/user-3.png" alt="Generic placeholder image">
	                                        <div class="media-body">
	                                            <a href="#" class="text-custom reply-btn"><i class="mdi mdi-reply"></i>&nbsp; Reply</a>
	                                            <h4 class="media-heading"><a href="">James Whitley</a></h4>
	                                            <p class="text-muted post-date">Jun 23, 2017, 11:45 am</p>
	                                            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nam viverra euismod odio, gravida pellentesque urna varius vitae. Sed dui lorem, adipiscing in adipiscing et, interdum nec metus. Mauris ultricies, justo eu convallis placerat, felis enim.</p>
	                                        </div>
	                                    </div>
	                                </div>
	                            </li>      

	                        </ul>

	                        <div class="mt-5">
	                            <h5 class="page-title-alt"><span>Leave a reply</span></h5>
	                        </div>

	                        <form action="#" method="post" class="mt-4">
	                            <div class="row">
	                                <div class="col-sm-6">
	                                    <div class="form-group">
	                                        <input id="author" class="form-control" placeholder="Name*" name="author" type="text" required="">
	                                    </div>
	                                </div>

	                                <div class="col-sm-6">
	                                    <div class="form-group">
	                                        <input id="email" class="form-control" placeholder="Email*" name="email" type="text" required="">
	                                    </div>
	                                </div>
	                            </div>
	                            <div class="row">
	                                <div class="col-sm-12">
	                                    <div class="form-group">
	                                        <input id="subject" class="form-control" placeholder="Website" name="subject" type="text">
	                                    </div>
	                                </div>
	                            </div>

	                            <div class="row">
	                                <div class="col-sm-12">
	                                    <div class="form-group">
	                                        <textarea id="comment" class="form-control" rows="5" placeholder="Your Message*" name="comment" required=""></textarea>
	                                    </div>
	                                </div>
	                            </div>

	                            <div class="row">
	                                <div class="col-sm-12">
	                                    <div class="form-group">
	                                        <button name="submit" type="submit" id="submit" class="btn btn-dark">Post Comment</button>
	                                    </div>
	                                </div>
	                            </div>
	                        </form>

	                    </div>

	                </article>
	                

	            </div>
	            

				
	            <div class="col-xl-4">
        			<div class="sidebar">
    
    <aside class="widget widget_search">
        <form>
            <input class="form-control pr-5" type="search" placeholder="Search...">
            <button class="search-button" type="submit"><span class="mdi mdi-magnify"></span></button>
        </form>
    </aside>

    <aside class="widget about-widget">
        <div class="widget-title">About Me</div>

        <div class="text-center">
            <img src="https://samblog-a664e.firebaseapp.com/images/photo.jpg" alt="About Me" class="rounded-circle">

            <p>Quis vero phasellus hac nullam, in quam vitae duis adipiscing mauris leo, laoreet eget at quis, ante vestibulum vivamus vel. Sapien lobortis, eget orci purus amet pede, consectetur neque risus.</p>
        </div>

    </aside>

    <aside class="widget about-widget">
        <div class="widget-title">Subscribe & Follow</div>

        <ul class="socials">
            <li><a href="https://www.facebook.com/mistar.adesoga"><i class="mdi mdi-facebook"></i></a></li>
            <li><a href="https://twitter.com/sadesoga"><i class="mdi mdi-twitter"></i></a></li>
            <li><a href="https://www.instagram.com/mistaradesoga/"><i class="mdi mdi-instagram"></i></a></li>
            <li><a href="https://uk.linkedin.com/in/samueladesoga"><i class="mdi mdi-linkedin"></i></a></li>
        </ul>

    </aside>

    
    <aside class="widget widget_categories">
        <div class="widget-title">Categories</div>
        <ul>
            
                <li><a href="https://samblog-a664e.firebaseapp.com/categories/agile-delivery">Agile delivery &nbsp;<span>(8)</span></a></li>
            
                <li><a href="https://samblog-a664e.firebaseapp.com/categories/technical">Technical &nbsp;<span>(47)</span></a></li>
            
        </ul>
    </aside>

    
    <aside class="widget widget_recent_entries_custom">
        <div class="widget-title">Popular Posts</div>
        <ul>
            
        </ul>
    </aside>

    
    <aside class="widget">
        <div class="widget-title">Archives</div>

        <ul>
            <li><a href="#">March 2017</a> (40)</li>
            <li><a href="#">April 2017</a> (08)</li>
            <li><a href="#">May 2017</a> (11)</li>
            <li><a href="#">Jun 2017</a> (21)</li>
        </ul>

    </aside>

    
    <aside class="widget widget_tag_cloud">
        <div class="widget-title">Tags</div>
        <div class="tagcloud">
            
                <a href="/tags/active-record">active-record</a>
            
                <a href="/tags/automation">automation</a>
            
                <a href="/tags/aws-s3">aws-s3</a>
            
                <a href="/tags/bdd">bdd</a>
            
                <a href="/tags/blogger">blogger</a>
            
                <a href="/tags/build">build</a>
            
                <a href="/tags/conference">conference</a>
            
                <a href="/tags/cqrs">cqrs</a>
            
                <a href="/tags/css-selectors">css-selectors</a>
            
                <a href="/tags/database">database</a>
            
                <a href="/tags/deployment">deployment</a>
            
                <a href="/tags/development">development</a>
            
                <a href="/tags/event-based-architecture">event-based-architecture</a>
            
                <a href="/tags/exploratory-testing">exploratory-testing</a>
            
                <a href="/tags/feature-driven-development">feature-driven-development</a>
            
                <a href="/tags/firefox">firefox</a>
            
                <a href="/tags/hardware">hardware</a>
            
                <a href="/tags/iehta">iehta</a>
            
                <a href="/tags/iexplore">iexplore</a>
            
                <a href="/tags/iexploreproxy">iexploreproxy</a>
            
                <a href="/tags/image-upload">image-upload</a>
            
                <a href="/tags/jar">jar</a>
            
                <a href="/tags/java">java</a>
            
                <a href="/tags/javascipt">javascipt</a>
            
                <a href="/tags/javascript-events">javascript-events</a>
            
                <a href="/tags/jmeter">jmeter</a>
            
                <a href="/tags/kanban">kanban</a>
            
                <a href="/tags/meeting">meeting</a>
            
                <a href="/tags/microsoft">microsoft</a>
            
                <a href="/tags/outlook">outlook</a>
            
                <a href="/tags/performance-testing">performance-testing</a>
            
                <a href="/tags/qa">qa</a>
            
                <a href="/tags/regex">regex</a>
            
                <a href="/tags/ruby">ruby</a>
            
                <a href="/tags/ruby-on-rails">ruby-on-rails</a>
            
                <a href="/tags/selenium">selenium</a>
            
                <a href="/tags/selenium-server">selenium-server</a>
            
                <a href="/tags/software-testing">software-testing</a>
            
                <a href="/tags/start-up">start-up</a>
            
                <a href="/tags/sysadmin">sysadmin</a>
            
                <a href="/tags/technical-testing">technical-testing</a>
            
                <a href="/tags/test">test</a>
            
                <a href="/tags/test-automation">test-automation</a>
            
                <a href="/tags/test-strategy">test-strategy</a>
            
                <a href="/tags/testing">testing</a>
            
                <a href="/tags/training">training</a>
            
                <a href="/tags/ubuntu">ubuntu</a>
            
                <a href="/tags/watir-webdriver">watir-webdriver</a>
            
                <a href="/tags/web-application">web-application</a>
            
                <a href="/tags/windows">windows</a>
            
                <a href="/tags/windows-application">windows-application</a>
            
                <a href="/tags/wordpress">wordpress</a>
            
                <a href="/tags/xp-antirus-2009">xp-antirus-2009</a>
            
                <a href="/tags/xpath">xpath</a>
            
        </div>
    </aside>
</div>
    			</div>
				

	        </div>

	    </div>
	    
	</section>

            </div>
        </div>
        
        <script src="https://samblog-a664e.firebaseapp.com/js/jquery.min.js"></script>
        <script src="https://samblog-a664e.firebaseapp.com/js/popper.min.js"></script>
        <script src="https://samblog-a664e.firebaseapp.com/js/bootstrap.min.js"></script>
        <script src="https://samblog-a664e.firebaseapp.com/js/jquery.easing.min.js"></script>
        <script src="https://samblog-a664e.firebaseapp.com/js/metisMenu.min.js"></script>
        
        <script src="https://samblog-a664e.firebaseapp.com/js/jquery.app.js"></script>
    </body>

</html>